{%- block toggle_password_widget -%}
  {#
    Template for password field with visibility toggle

    Available variables:
    - visible_label: Label when password is hidden (default: "Show")
    - hidden_label: Label when password is visible (default: "Hide")
    - visible_icon: UX icon when password is hidden (default: "tabler:eye-off")
    - hidden_icon: UX icon when password is visible (default: "tabler:eye")
    - toggle_container_classes: CSS classes for the container

    NATIVE TOGGLE: Uses inline onclick to avoid conflicts with LiveComponent
    Does NOT use Stimulus - Pure JavaScript for maximum compatibility
  #}

  <div class="input-group input-group-merge form-password-toggle {{ (toggle_container_classes ?? [])|join(' ') }}">
    {%- set type = type|default('password') -%}
    <input type="{{ type }}" {{ block('widget_attributes') }} {% if value is not empty %}value="{{ value }}" {% endif %}/>
    <span class="input-group-text cursor-pointer"
          role="button"
          tabindex="0"
          aria-label="{{ visible_label|default('Show password') }}"
          onclick="
            const input = this.previousElementSibling;
            const iconHidden = this.querySelector('.icon-hidden');
            const iconVisible = this.querySelector('.icon-visible');

            if (input.type === 'password') {
              input.type = 'text';
              iconHidden.classList.add('d-none');
              iconVisible.classList.remove('d-none');
              this.setAttribute('aria-label', '{{ hidden_label|default('Hide password') }}');
            } else {
              input.type = 'password';
              iconHidden.classList.remove('d-none');
              iconVisible.classList.add('d-none');
              this.setAttribute('aria-label', '{{ visible_label|default('Show password') }}');
            }
          ">
      {{ ux_icon(visible_icon|default('tabler:eye-off'), {class: 'icon-hidden icon-base ti tabler'}) }}
      {{ ux_icon(hidden_icon|default('tabler:eye'), {class: 'icon-visible d-none icon-base ti tabler'}) }}
    </span>
  </div>
{%- endblock toggle_password_widget -%}

